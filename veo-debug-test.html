<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEO Model Selection Debug Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .debug-section {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .debug-title {
            color: #60a5fa;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .debug-item {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border-radius: 4px;
            font-family: monospace;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
        .info { color: #3b82f6; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        #console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ VEO Model Selection Debug Test</h1>
    <p>è¿™ä¸ªé¡µé¢å¸®åŠ©éªŒè¯ VEO æ¨¡å‹é€‰æ‹©ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æµ‹è¯•ï¼š</p>

    <div class="debug-section">
        <div class="debug-title">ğŸ“‹ æµ‹è¯•æ­¥éª¤</div>
        <ol>
            <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)</li>
            <li>åˆ‡æ¢åˆ° Console æ ‡ç­¾é¡µ</li>
            <li>åˆ·æ–°ä¸»åº”ç”¨é¡µé¢</li>
            <li>åœ¨è§†é¢‘æ¨¡å‹é€‰æ‹©å™¨ä¸­é€‰æ‹©ä»»æ„ VEO æ¨¡å‹ (veo3, veo3-pro, veo3-fast, veo3.1, veo3.1-pro)</li>
            <li>åˆ›å»ºä¸€ä¸ªè§†é¢‘å—å¹¶è¾“å…¥æç¤ºè¯</li>
            <li>ç‚¹å‡»ç”ŸæˆæŒ‰é’®</li>
            <li>è§‚å¯Ÿæ§åˆ¶å°è¾“å‡º</li>
        </ol>
    </div>

    <div class="debug-section">
        <div class="debug-title">ğŸ” éœ€è¦æŸ¥æ‰¾çš„è°ƒè¯•ä¿¡æ¯</div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] App component loaded:</strong><br>
            åº”è¯¥æ˜¾ç¤ºåº”ç”¨åˆå§‹åŒ–ä¿¡æ¯å’Œç¼“å­˜æ¸…é™¤
        </div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] ModelSelector model selected:</strong><br>
            å½“é€‰æ‹© VEO æ¨¡å‹æ—¶åº”è¯¥æ˜¾ç¤ºï¼ŒisVeoModel åº”è¯¥ä¸º true
        </div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] App.tsx video generation:</strong><br>
            ç”Ÿæˆè§†é¢‘æ—¶åº”è¯¥æ˜¾ç¤ºï¼ŒisVeoModel åº”è¯¥ä¸º true
        </div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] AIServiceAdapter.generateVideo called:</strong><br>
            åº”è¯¥æ˜¾ç¤º VEO æ¨¡å‹è¢«æ­£ç¡®ä¼ é€’åˆ°é€‚é…å™¨
        </div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] ShenmaService.generateVideo called:</strong><br>
            åº”è¯¥æ˜¾ç¤º VEO æ¨¡å‹è¢«æ­£ç¡®ä¼ é€’åˆ°æœåŠ¡
        </div>
        <div class="debug-item">
            <strong class="success">[VEO-DEBUG] âœ… VEO3 generation path taken:</strong><br>
            åº”è¯¥æ˜¾ç¤º VEO3 ç”Ÿæˆè·¯å¾„è¢«é€‰æ‹©
        </div>
    </div>

    <div class="debug-section">
        <div class="debug-title">âŒ é—®é¢˜è¯Šæ–­</div>
        <div class="debug-item">
            <strong class="error">å¦‚æœçœ‹ä¸åˆ°ä»»ä½• [VEO-DEBUG] ä¿¡æ¯ï¼š</strong><br>
            å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼Œè¯·å°è¯•ï¼š<br>
            1. ç¡¬åˆ·æ–°é¡µé¢ (Ctrl+Shift+R æˆ– Cmd+Shift+R)<br>
            2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜<br>
            3. åœ¨å¼€å‘è€…å·¥å…·ä¸­ç¦ç”¨ç¼“å­˜
        </div>
        <div class="debug-item">
            <strong class="warning">å¦‚æœ isVeoModel æ˜¾ç¤ºä¸º falseï¼š</strong><br>
            è¯´æ˜æ¨¡å‹é€‰æ‹©å™¨æ²¡æœ‰æ­£ç¡®ä¼ é€’ VEO æ¨¡å‹ IDï¼Œæ£€æŸ¥ï¼š<br>
            1. æ¨¡å‹é€‰æ‹©å™¨æ˜¯å¦æ­£ç¡®æ›´æ–°äº† modelConfig<br>
            2. getProviderSettings å‡½æ•°æ˜¯å¦æ­£ç¡®æå–äº†æ¨¡å‹ ID
        </div>
        <div class="debug-item">
            <strong class="warning">å¦‚æœæ²¡æœ‰çœ‹åˆ° VEO3 generation pathï¼š</strong><br>
            è¯´æ˜ VEO æ£€æµ‹é€»è¾‘æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š<br>
            1. options?.model æ˜¯å¦åŒ…å« 'veo' å­—ç¬¦ä¸²<br>
            2. æ¨¡å‹ ID æ˜¯å¦è¢«æ­£ç¡®ä¼ é€’åˆ° ShenmaService
        </div>
    </div>

    <div class="debug-section">
        <div class="debug-title">ğŸ› ï¸ ç¼“å­˜æ¸…é™¤å·¥å…·</div>
        <button onclick="clearBrowserCache()">æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</button>
        <button onclick="forceReload()">å¼ºåˆ¶é‡æ–°åŠ è½½</button>
        <button onclick="checkConsole()">æ£€æŸ¥æ§åˆ¶å°è¾“å‡º</button>
        <button onclick="testVeoDetection()">æµ‹è¯• VEO æ£€æµ‹é€»è¾‘</button>
    </div>

    <div class="debug-section">
        <div class="debug-title">ğŸ“Š æ§åˆ¶å°è¾“å‡ºç›‘æ§</div>
        <div id="console-output">ç­‰å¾…æ§åˆ¶å°è¾“å‡º...</div>
    </div>

    <script>
        // ç›‘æ§æ§åˆ¶å°è¾“å‡º
        const originalLog = console.log;
        const outputDiv = document.getElementById('console-output');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            if (message.includes('[VEO-DEBUG]') || message.includes('[VEO-VERIFY]')) {
                const timestamp = new Date().toLocaleTimeString();
                outputDiv.textContent += `[${timestamp}] ${message}\n`;
                outputDiv.scrollTop = outputDiv.scrollHeight;
            }
        };

        function clearBrowserCache() {
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => {
                        caches.delete(name);
                    });
                });
            }
            localStorage.clear();
            sessionStorage.clear();
            alert('ç¼“å­˜å·²æ¸…é™¤ï¼Œè¯·åˆ·æ–°é¡µé¢');
        }

        function forceReload() {
            window.location.reload(true);
        }

        function checkConsole() {
            console.log('[VEO-DEBUG] Manual console check at', new Date().toISOString());
            alert('è¯·æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º');
        }

        function testVeoDetection() {
            const testModels = ['veo3', 'veo3-pro', 'veo3-fast', 'veo3.1', 'veo3.1-pro', 'sora_video2'];
            testModels.forEach(model => {
                const isVeo = model.includes('veo');
                console.log(`[VEO-DEBUG] Test detection: ${model} -> isVeo: ${isVeo}`);
            });
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        console.log('[VEO-DEBUG] Debug test page loaded at', new Date().toISOString());
        console.log('[VEO-DEBUG] User agent:', navigator.userAgent);
        console.log('[VEO-DEBUG] Cache buster:', Date.now());
    </script>
</body>
</html>